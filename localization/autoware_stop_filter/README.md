## 停止フィルター

## 目的

この関数が存在しない場合、各ノードは車両の停止の判断に異なる基準を使用するため、一部のノードでは車両が停止中でも操作が継続し、一部のノードでは走行モードで動作を継続していました。
このノードの目的は次のとおりです。

- 複数のノードに均一な停止決定基準を適用する
- 速度と角速度をゼロで上書きすることで制御ノイズを抑える

## 入出力

### 入力

| 名前          | タイプ                      | 説明                             |
| ------------ | ------------------------- | ---------------------------- |
| `input/odom` | `nav_msgs::msg::Odometry` | ローカリゼーションのオドメトリ  |

### 出力

経路生成パイプラインは、Planningコンポーネント/モジュールの一部であり、Perceptionコンポーネント/モジュールによって提供される環境認識情報と、Reference Path Handler（RPH）によって生成された現在の経路を考慮して、新たな経路候補を生成します。

**入力:**

* 局所マップ
* 交通信号情報
* 現在の経路
* 自車位置
* 自車速度

**出力:**

* 新たな経路候補

**処理:**

経路生成パイプラインは、以下のステップに従って動作します。

1. **局所マップに障害物を追加:** Perceptionコンポーネント/モジュールによって提供される障害物を局所マップに追加します。
2. **交通信号情報を考慮:** Traffic Light Manager（TLM）によって生成された交通信号情報を考慮します。
3. **経路候補候補の生成:** 現在のパスの周囲に経路候補候補のセットを生成します。
4. **経路候補のスコア付け:** 経路候補候補にスコアを付けます。スコアは、以下の要因に基づいています。
    * 安全性: 障害物との距離、交通法規の遵守、交通信号の遵守
    * 快適性: 走行経路の滑らかさ、加速と減速の最小化
5. **最適な経路候補の選択:** 最も高いスコアを持つ経路候補を選択します。
6. **`post resampling`:** 選択された経路候補に対して`post resampling`を行い、滑らかで現実的な経路にします。

| 名称              | 型                                 | 説明                                                 |
| ----------------- | ------------------------------------ | ------------------------------------------------------ |
| `output/odom`     | `nav_msgs::msg::Odometry`            | longitudinalとyaw twistを抑制されたオドメトリ      |
| `debug/stop_flag` | `tier4_debug_msgs::msg::BoolStamped` | 車両が停止しているかどうかを表すフラグ            |

## パラメータ

{{ json_to_markdown("localization/autoware_stop_filter/schema/stop_filter.schema.json") }}

