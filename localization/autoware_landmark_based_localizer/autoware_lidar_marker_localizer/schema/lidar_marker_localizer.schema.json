{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Parameters for Lidar Marker Localizer Node",
  "type": "object",
  "definitions": {
    "lidar_marker_localizer": {
      "type": "object",
      "properties": {
        "enable_read_all_target_ids": {
          "type": "boolean",
          "description": "",
          "default": true
        },
        "target_ids": {
          "type": "array",
          "description": "List of target marker IDs to be detected.",
          "default": ["0000", "0001", "0002", "0003", "0004", "0005"]
        },
        "queue_size_for_output_pose": {
          "type": "number",
          "description": "Queue size for output/pose_with_covariance publisher",
          "default": 10,
          "minimum": 0
        },
        "marker_name": {
          "type": "string",
          "description": "The name of the markers listed in the HD map.",
          "default": "reflector"
        },
        "road_surface_mode": {
          "type": "boolean",
          "description": "Enable road surface mode for marker detection.",
          "default": false
        },
        "resolution": {
          "type": "number",
          "description": "Grid size for marker detection algorithm. [m]",
          "default": 0.05,
          "minimum": 0.0
        },
        "intensity_pattern": {
          "type": "array",
          "description": "A sequence of high/low intensity to perform pattern matching. 1: high intensity (positive match), 0: not consider, -1: low intensity (negative match)",
          "default": [-1, -1, 0, 1, 1, 1, 1, 1, 0, -1, -1]
        },
        "match_intensity_difference_threshold": {
          "type": "number",
          "description": "Threshold for determining high/low.",
          "default": 20,
          "minimum": 0
        },
        "positive_match_num_threshold": {
          "type": "number",
          "description": "Threshold for the number of required matches with the pattern.",
          "default": 3,
          "minimum": 0
        },
        "negative_match_num_threshold": {
          "type": "number",
          "description": "Threshold for the number of required matches with the pattern.",
          "default": 3,
          "minimum": 0
        },
        "vote_threshold_for_detect_marker": {
          "type": "number",
          "description": "Threshold for the number of rings matching the pattern needed to detect it as a marker.",
          "default": 20,
          "minimum": 0
        },
        "marker_to_vehicle_offset_y": {
          "type": "number",
          "description": "Y-axis offset from the center of the marker to vehicle. [m]",
          "default": 0.0
        },
        "marker_height_from_ground": {
          "type": "number",
          "description": "Height from the ground to the center of the marker. [m]",
          "default": 1.075
        },
        "lower_ring_id_init": {
          "type": "number",
          "description": "Initial value when searching for the lowest ring ID within the point cloud",
          "default": 128,
          "minimum": 0
        },
        "upper_ring_id_init": {
          "type": "number",
          "description": "Initial value when searching for the highest ring ID within the point cloud",
          "default": 0,
          "minimum": 0
        },
        "reference_ring_number": {
          "type": "number",
          "description": "Reference ring number when detecting the marker. Set 255 to disable ring filtering",
          "default": 255
        },
        "self_pose_timeout_sec": {
          "type": "number",
          "description": "Timeout for self pose. [sec]",
          "default": 1.0,
          "minimum": 0.0
        },
        "self_pose_distance_tolerance_m": {
          "type": "number",
          "description": "Tolerance for the distance between two points when performing linear interpolation. [m]",
          "default": 1.0,
          "minimum": 0.0
        },
        "limit_distance_from_self_pose_to_nearest_marker": {
          "type": "number",
          "description": "Distance limit for the purpose of determining whether the node should detect a marker. [m]",
          "default": 2.0,
          "minimum": 0.0
        },
        "limit_distance_from_self_pose_to_nearest_marker_y": {
          "type": "number",
          "description": "Y-axis distance limit for the purpose of determining whether the node should detect a marker. [m]",
          "default": 1.0,
          "minimum": 0.0
        },
        "limit_distance_from_self_pose_to_marker": {
          "type": "number",
          "description": "Distance limit for avoiding miss detection. [m]",
          "default": 2.0,
          "minimum": 0.0
        },
        "base_covariance": {
          "type": "array",
          "description": "Output covariance in the base_link coordinate.",
          "default": [
            0.04, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.04, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0, 0.00007569, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00007569, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.00030625
          ]
        },
        "enable_save_log": {
          "type": "boolean",
          "description": "",
          "default": false
        },
        "save_file_directory_path": {
          "type": "string",
          "description": "",
          "default": "$(env HOME)/detected_reflector_intensity"
        },
        "save_file_name": {
          "type": "string",
          "description": "",
          "default": "detected_reflector_intensity"
        },
        "save_frame_id": {
          "type": "string",
          "description": "",
          "default": "velodyne_top"
        },
        "radius_for_extracting_marker_pointcloud": {
          "type": "number",
          "description": "Only points closer than this value to the marker center on the xy plane are extracted as the “marker point cloud”. [m]",
          "default": 0.4,
          "minimum": 0.0
        },
        "queue_size_for_debug_pub_msg": {
          "type": "number",
          "description": "Queue size for debug publishers",
          "default": 10,
          "minimum": 0.0
        }
      },
      "required": [
        "resolution",
        "intensity_pattern",
        "match_intensity_difference_threshold",
        "positive_match_num_threshold",
        "negative_match_num_threshold",
        "vote_threshold_for_detect_marker",
        "marker_to_vehicle_offset_y",
        "marker_height_from_ground",
        "reference_ring_number",
        "self_pose_timeout_sec",
        "self_pose_distance_tolerance_m",
        "limit_distance_from_self_pose_to_nearest_marker",
        "limit_distance_from_self_pose_to_nearest_marker_y",
        "limit_distance_from_self_pose_to_marker",
        "base_covariance",
        "enable_save_log",
        "save_file_directory_path",
        "save_file_name",
        "save_frame_id"
      ],
      "additionalProperties": false
    }
  },
  "properties": {
    "/**": {
      "type": "object",
      "properties": {
        "ros__parameters": {
          "$ref": "#/definitions/lidar_marker_localizer"
        }
      },
      "required": ["ros__parameters"],
      "additionalProperties": false
    }
  },
  "required": ["/**"],
  "additionalProperties": false
}
