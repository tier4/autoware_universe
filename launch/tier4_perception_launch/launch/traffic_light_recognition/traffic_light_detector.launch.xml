<?xml version="1.0"?>
<launch>
  <group>
    <!-- add namespace -->
    <arg name="namespace" default="camera6"/>
    <arg name="input/image" default="/sensing/camera/$(var namespace)/image_raw"/>
    <arg name="yolox_detected_traffic/rois" default="/perception/traffic_light_recognition/$(var namespace)/detection/yolox/rois"/>
    <arg name="use_decompress" default="true" description="use image decompress"/>
    <arg name="build_only" default="false" description="exit after trt engine is built"/>

    <arg name="input/rough_rois" default="/perception/traffic_light_recognition/$(var namespace)/detection/rough/rois"/>
    <arg name="output/traffic_light_rois" default="/perception/traffic_light_recognition/$(var namespace)/detection/rois"/>
    <arg name="input/expect_rois" default="/perception/traffic_light_recognition/$(var namespace)/detection/expect/rois"/>
    <arg name="input/camera_info" default="/sensing/camera/$(var namespace)/camera_info"/>

    <include file="$(find-pkg-share autoware_tensorrt_yolox)/launch/yolox_traffic_light_detector.launch.xml">
      <arg name="use_decompress" value="$(var use_decompress)"/>
      <arg name="build_only" value="$(var build_only)"/>
      <arg name="input/image" value="$(var input/image)"/>
      <arg name="output/objects" value="$(var yolox_detected_traffic/rois)"/>
    </include>

    <!-- Node -->
    <node pkg="autoware_traffic_light_selector" exec="traffic_light_selector_node" name="autoware_traffic_light_selector_$(var namespace)" output="screen">
      <remap from="input/detected_rois" to="$(var yolox_detected_traffic/rois)"/>
      <remap from="input/rough_rois" to="$(var input/rough_rois)"/>
      <remap from="input/expect_rois" to="$(var input/expect_rois)"/>
      <remap from="output/traffic_light_rois" to="$(var output/traffic_light_rois)"/>
      <remap from="input/camera_info" to="$(var input/camera_info)"/>
      <param name="max_iou_threshold" value="0.0"/>
      <param name="debug" value="true"/>
    </node>
  </group>
</launch>
