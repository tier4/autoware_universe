autoware_system_design_format: v0.1.0

# node information
name: TrafficLightMultiCameraFusion.node

launch:
  package: autoware_traffic_light_multi_camera_fusion
  plugin: autoware::traffic_light::MultiCameraFusion
  executable: traffic_light_multi_camera_fusion_node
  node_output: screen
  use_container: false
  container_name: pointcloud_container

# interfaces
inputs:
  - name: vector_map
    message_type: autoware_map_msgs/msg/LaneletMapBin
  - name: camera1/camera_info
    message_type: sensor_msgs/msg/CameraInfo
    remap_target: camera1/camera_info
  - name: camera1/classification/traffic_signals
    message_type: tier4_perception_msgs/msg/TrafficLightArray
    remap_target: camera1/classification/traffic_signals
  - name: camera1/detection/rois
    message_type: tier4_perception_msgs/msg/TrafficLightRoiArray
    remap_target: camera1/detection/rois
  - name: camera2/camera_info
    message_type: sensor_msgs/msg/CameraInfo
    remap_target: camera2/camera_info
  - name: camera2/classification/traffic_signals
    message_type: tier4_perception_msgs/msg/TrafficLightArray
    remap_target: camera2/classification/traffic_signals
  - name: camera2/detection/rois
    message_type: tier4_perception_msgs/msg/TrafficLightRoiArray
    remap_target: camera2/detection/rois
outputs:
  - name: traffic_signals
    message_type: tier4_perception_msgs/msg/TrafficLightGroupArray
    qos:
      reliability: reliable
      durability: transient_local

# parameters
parameter_files:
  - name: param_path
    default: config/traffic_light_multi_camera_fusion.param.yaml

parameters:
  - name: camera_namespaces
    type: array
    default: "['camera1', 'camera2']"
    description: List of camera namespaces to be used for fusion.

# processes
processes:
  - name: process
    trigger_conditions:
      - or:
        - and:
          - on_input: camera1/camera_info
          - on_input: camera1/classification/traffic_signals
          - on_input: camera1/detection/rois
        - and:
          - on_input: camera2/camera_info
          - on_input: camera2/classification/traffic_signals
          - on_input: camera2/detection/rois
    outcomes:
      - to_output: traffic_signals
